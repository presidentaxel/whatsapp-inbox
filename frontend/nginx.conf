server {
    listen 80;
    server_name _;

    root /usr/share/nginx/html;
    index index.html;

    # Proxy /api vers le backend
    location /api {
        # Utiliser la variable d'environnement VITE_BACKEND_URL si disponible
        # Sinon, supposer que le backend est sur le même domaine (pour Render)
        # Render expose le backend sur un port interne, mais en production
        # on peut utiliser un reverse proxy ou une URL externe
        
        # Pour Render, si backend et frontend sont sur le même domaine,
        # on peut utiliser un sous-domaine ou une URL différente
        # Ici, on va utiliser une variable d'environnement ou une URL par défaut
        
        # Si VITE_BACKEND_URL est défini, l'utiliser
        # Sinon, essayer de proxy vers le backend local (ne fonctionnera pas sur Render)
        # La meilleure solution est de configurer VITE_BACKEND_URL dans Render
        
        # Pour l'instant, on va laisser le frontend gérer ça via axios
        # et on va créer les endpoints sans /api pour qu'ils soient accessibles directement
        try_files $uri /index.html;
    }

    location / {
        try_files $uri /index.html;
    }
}